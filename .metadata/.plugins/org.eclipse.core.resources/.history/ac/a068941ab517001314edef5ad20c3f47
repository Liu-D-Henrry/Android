package com.will.phoneblocker;

import java.util.ArrayList;
import java.util.HashMap;

import android.app.Application;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;

public class BlockerApplication extends Application {

	private static final String DATABASE_NAME = "BlackList.db3";
	public static final String TABLE_NAME = "blacklist";
	
	private boolean serviceRunning;
	private MySQLiteOpenHelper dbHelper;
	private SQLiteDatabase db;
	
	@Override
	public void onCreate() {
		// TODO Auto-generated method stub
		super.onCreate();
		dbHelper = new MySQLiteOpenHelper(this, DATABASE_NAME, 1);
	}

	@Override
	public void onTerminate() {
		// TODO Auto-generated method stub
		if (dbHelper != null) {
			dbHelper.close();
		}
		super.onTerminate();
	}

	public ArrayList<HashMap<String, String>> getBlackList() {
		ArrayList<HashMap<String, String>> blackNumberList = new ArrayList<HashMap<String, String>>();
		SQLiteDatabase db = dbHelper.getReadableDatabase();
		Cursor cursor = db.query(TABLE_NAME, null, null, null, null, null, null);
		while (cursor.moveToNext()) {
			HashMap<String, String> map = new HashMap<String, String>();
			map.put("phone", cursor.getString(cursor.getColumnIndex("phone")));
			blackNumberList.add(map);
		}
		
		return blackNumberList;
	}
	
	public void insertData(String name, String phone) {
		SQLiteDatabase db = dbHelper.getReadableDatabase();
		db.execSQL("insert into " + TABLE_NAME + " values(null, ?, ?)", new String[] {name, phone});
	}
	
	public boolean isServiceRunning() {
		return this.serviceRunning;
	}
	
	public void setServiceRunning(boolean isServiceRunning) {
		this.serviceRunning = isServiceRunning;
	}
}
